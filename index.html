<!DOCTYPE html>
<html lang="en">

<script src="https://cdn.rawgit.com/davidshimjs/qrcodejs/gh-pages/qrcode.min.js"></script>

<head>
    <title>FRC Scouting Application</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- import the webpage's javascript file -->

</head>

<body>

    <header>
        <h1>FRC Scouting Application</h1>
        <button id="dark_mode">Toggle Dark Mode</button>
        initialize()
    </header>

    <main>
        <div class="match_info">
            <label for="scout_name">Scout Name: </label>
            <input type="text" id="scout_name" name="scoutName">
            <label for="team_number">Team Number:</label>
            <input type="number" id="team_number" name="teamNumber">
            <label for="match_number">Match Number:</label>
            <input type="number" id="match_number" name="matchNumber">
            <label for="alliance_color">Alliance Color:</label>
            <select id="alliance_color">
                <option value="red">Red</option>
                <option value="blue">Blue</option>
            </select>
        </div> <br>

        <div class="start_info">
            <label for="robot_present">Robot Present in Match:</label>
            <select id="robot_present">
                <option value="yes">Yes</option>
                <option value="no">No</option>
            </select>
            <label for="exited_tarmac">Exited Tarmac:</label>
            <select id="exited_tarmac">
                <option value="yes">Yes</option>
                <option value="no">No</option>
            </select>
        </div><br>

        <div class="map">
            <p>Select the balls that the robot picks up during auton. </p>
            <img id="fieldMap" src="assets/GameFieldZoned.png" usemap="#fieldmap">
            <map name="fieldmap">
                <area id="zone14" shape="circle" coords="209, 262, 16" />
                <area id="zone13" shape="circle" coords="311, 326, 16" />
                <area id="zone12" shape="circle" coords="372, 322, 16" />
                <area id="zone11" shape="circle" coords="427, 299, 16" />
                <area id="zone10" shape="circle" coords="471, 253, 16" />
                <area id="zone9" shape="circle" coords="491, 134, 16" />
                <area id="zone8" shape="circle" coords="627, 50, 16" />
                <area id="zone7" shape="circle" coords="465, 78, 16" />
                <area id="zone6" shape="circle" coords="364, 15, 16" />
                <area id="zone5" shape="circle" coords="304, 18, 16" />
                <area id="zone4" shape="circle" coords="246, 39, 16" />
                <area id="zone3" shape="circle" coords="205, 88, 16" />
                <area id="zone2" shape="circle" coords="185, 205, 16" />
                <area id="zone1" shape="circle" coords="45, 291, 16" />
            </map>
            <p id="zone_display">Balls Selected:</p>
        </div>
        <div class="auton">
            <h2>Autonomous Period</h2>
            <div class="point_buttons">
                <div>
                    <h3>High Goal</h3>
                    <button class="decrement" id="decrement_auton_high">-</button>
                    <button type="button" class="increment" id="increment_auton_high" onclick="inc_auton_high()">Add
                        Point</button>
                    <h3 id="auton_high">0</h3>
                </div>
                <div>
                    <h3>Low Goal</h3>
                    <button class="decrement" id="decrement_auton_low">-</button>
                    <button class="increment" id="increment_auton_low">Add Point</button>
                    <h3 id="auton_low">0</h3><br>
                </div>
            </div>
        </div> <br>

        <div class="teleop">
            <h2>Teleoperated Period</h2>
            <div class="point_buttons">
                <div>
                    <h3>High Goal</h3>
                    <button class="decrement" id="decrement_teleop_high">-</button>
                    <button class="increment" id="increment_teleop_high">Add Point</button>
                    <h3 id="teleop_high">#</h3>
                </div>
                <div>
                    <h3>Low Goal</h3>
                    <button class="decrement" id="decrement_teleop_low">-</button>
                    <button class="increment" id="increment_teleop_low">Add Point</button>
                    <h3 id="teleop_low">#</h3><br>
                </div>
            </div>
        </div> <br>

        <div class="opposing">
            <h2>Opposing Cargo Scored</h2>
            <div class="point_buttons">
                <div>
                    <h3>High Goal</h3>
                    <button class="decrement" id="decrement_opposing_high">-</button>
                    <button class="increment" id="increment_opposing_high">Add Point</button>
                    <h3 id="opposing_high">#</h3>
                </div>
                <div>
                    <h3>Low Goal</h3>
                    <button class="decrement" id="decrement_opposing_low">-</button>
                    <button class="increment" id="increment_opposing_low">Add Point</button>
                    <h3 id="opposing_low">#</h3><br>
                </div>
            </div>
        </div> <br>

        <div class="other">
            <h2>Scoring Position <button id="reset_score_pos">Reset</button></h2>
            <div class="score_position_buttons">
                <button id="tarmac">Tarmac</button>
                <button id="launchpad">Launch Pad</button>
                <button id="other">Other</button>
            </div>

            <h2>Climb Level <button id="reset_climb">Reset</button></h2>
            <div class="climb_buttons">
                <button id="none">None</button>
                <button id="attempted">Attempted</button>
                <button id="low">Low</button>
                <button id="middle">Middle</button>
                <button id="high">High</button>
                <button id="traversal">Traversal</button>
            </div>
        </div> <br>

        <div class="flags">
            <h2>Fouls and Flags <button id="reset_flags">Reset</button></h2>
            <button id="foul">Foul</button>
            <button id="tech_foul">Tech Foul</button>
            <button id="yellow">Yellow Card</button>
            <button id="red">Red Card</button><br>
            <button id="crashing">Uncontrolled Crashing</button>
            <button id="opposing">Scored Opposing Cargo</button>
            <button id="drivetrain">Broken Drivetrain</button>
            <button id="defense">Played Defense</button>
        </div> <br>

        <div>
            <button id="generate_qr" onclick="gather">Generate QR Code</button>
            <button id="clear" onclick="clear">Clear</button>
            <div id="display"></div>
        </div>
    </main>
</body>
<script>

    var data = "";


    var autonHigh = document.getElementById("auton_high");
    var autonLow = document.getElementById("auton_low");
    var teleopHigh = document.getElementById("teleop_high");
    var teleopLow = document.getElementById("teleop_low");
    var opposingHigh = document.getElementById("opposing_high");
    var opposingLow = document.getElementById("opposing_low");

    var auton_high_scored = 0;
    var auton_low_scored = 0;
    var teleop_high_scored = 0;
    var teleop_low_scored = 0
    var opposing_high_scored = 0;
    var opposing_low_scored = 0;

    document.getElementById("dark_mode").addEventListener("click", function () {
        var element = document.body;
        element.classList.toggle("dark_mode");
    });

    function inc_auton_high() { console.log(auton_high_scored); auton_high_scored++; document.getElementById("auton_high").innerHTML = auton_high_scored; };
    function dec_auton_high() { auton_high_scored--; document.getElementById("auton_high").innerHTML = auton_high_scored; };

    document.getElementById("increment_auton_low").addEventListener("click", function () { auton_low_scored++; autonLow.innerHTML = auton_low_scored; });
    document.getElementById("decrement_auton_low").addEventListener("click", function () { auton_low_scored--; autonLow.innerHTML = auton_low_scored; });

    document.getElementById("increment_teleop_high").addEventListener("click", function () { teleop_high_scored++; teleopHigh.innerHTML = teleop_high_scored; });
    document.getElementById("decrement_teleop_high").addEventListener("click", function () { teleop_high_scored--; teleopHigh.innerHTML = teleop_high_scored; });

    document.getElementById("increment_teleop_low").addEventListener("click", function () { teleop_low_scored++; teleopLow.innerHTML = teleop_low_scored; });
    document.getElementById("decrement_teleop_low").addEventListener("click", function () { teleop_low_scored--; teleopLow.innerHTML = teleop_low_scored; });

    document.getElementById("increment_opposing_high").addEventListener("click", function () { opposing_high_scored++; opposingHigh.innerHTML = opposing_high_scored; });
    document.getElementById("decrement_opposing_high").addEventListener("click", function () { opposing_high_scored--; opposingHigh.innerHTML = opposing_high_scored; });

    document.getElementById("increment_opposing_low").addEventListener("click", function () { opposing_low_scored++; opposingLow.innerHTML = opposing_low_scored; });
    document.getElementById("decrement_opposing_low").addEventListener("click", function () { opposing_low_scored--; opposingLow.innerHTML = opposing_low_scored; });

    //scoring position
    var tarmac = document.getElementById("tarmac");
    var launch_pad = document.getElementById("launchpad");
    var other = document.getElementById("other");

    tarmac.addEventListener("click", function () { tarmac.disabled = true; });
    launchpad.addEventListener("click", function () { launchpad.disabled = true; });
    other.addEventListener("click", function () { other.disabled = true; });

    document.getElementById("reset_score_pos").addEventListener("click", function () {
        resetScorePos();
    })

    function resetScorePos() {
        tarmac.disabled = false;
        launchpad.disabled = false;
        other.disabled = false;
    }
    //climb level
    var none = document.getElementById("none");
    var attempted = document.getElementById("attempted");
    var low = document.getElementById("low");
    var middle = document.getElementById("middle");
    var high = document.getElementById("high");
    var traversal = document.getElementById("traversal");

    none.addEventListener("click", function () { none.disabled = true; });
    attempted.addEventListener("click", function () { attempted.disabled = true; });
    low.addEventListener("click", function () { low.disabled = true; });
    middle.addEventListener("click", function () { middle.disabled = true; });
    high.addEventListener("click", function () { high.disabled = true; });
    traversal.addEventListener("click", function () { traversal.disabled = true; });

    document.getElementById("reset_climb").addEventListener("click", function () {
        resetClimb()
    })

    function resetClimb() {
        none.disabled = false;
        attempted.disabled = false;
        low.disabled = false;
        middle.disabled = false;
        high.disabled = false;
        traversal.disabled = false;
    }

    //fouls
    var foul_object = document.getElementById("foul");
    var tech_foul_object = document.getElementById("tech_foul");
    var yellow_object = document.getElementById("yellow");
    var red_object = document.getElementById("red");

    foul_object.addEventListener("click", function () { foul_object.disabled = true; });
    tech_foul_object.addEventListener("click", function () { tech_foul_object.disabled = true; });
    yellow_object.addEventListener("click", function () { yellow_object.disabled = true; });
    red_object.addEventListener("click", function () { red_object.disabled = true; });

    //flags
    var crashing_object = document.getElementById("crashing");
    var opposing_object = document.getElementById("opposing");
    var drivetrain_object = document.getElementById("drivetrain");
    var defense_object = document.getElementById("defense");

    crashing_object.addEventListener("click", function () { crashing_object.disabled = true; });
    drivetrain_object.addEventListener("click", function () { drivetrain_object.disabled = true; });
    defense_object.addEventListener("click", function () { defense_object.disabled = true; });

    document.getElementById("reset_flags").addEventListener("click", function () {
        resetFlags();
    })

    function resetFlags() {
        foul_object.disabled = false;
        tech_foul_object.disabled = false;
        yellow_object.disabled = false;
        red_object.disabled = false;
        crashing_object.disabled = false;
        drivetrain_object.disabled = false;
        defense_object.disabled = false;
    }


    var startZone = "";
    var b1, b2, b3, b4, b5, b6, b7, b8, b9, b10, b11, b12, b13, b14 = false;
    document.getElementById("zone1").addEventListener("click", function () {
        startZone = "Zone1";
        b1 = !b1;
        if (b1) {
            document.getElementById("zone_display").innerHTML += " Ball 1,";
        } else { removeZone(" Ball 1,"); }
    });
    document.getElementById("zone2").addEventListener("click", function () {
        startZone = "Zone2";
        b2 = !b2;
        if (b2) {
            document.getElementById("zone_display").innerHTML += " Ball 2,";
        } else { removeZone(" Ball 2,"); }
    });
    document.getElementById("zone3").addEventListener("click", function () {
        startZone = "Zone3";
        b3 = !b3;
        if (b3) {
            document.getElementById("zone_display").innerHTML += " Ball 3,";
        } else { removeZone(" Ball 3,"); }
    });
    document.getElementById("zone4").addEventListener("click", function () {
        startZone = "Zone4";
        b4 = !b4;
        if (b4) {
            document.getElementById("zone_display").innerHTML += " Ball 4,";
        } else { removeZone(" Ball 4,"); }
    });

    document.getElementById("zone5").addEventListener("click", function () {
        startZone = "Zone5";
        b5 = !b5;
        if (b5) {
            document.getElementById("zone_display").innerHTML += " Ball 5,";
        } else { removeZone(" Ball 5,"); }
    });
    document.getElementById("zone6").addEventListener("click", function () {
        startZone = "Zone6";
        b6 = !b6;
        if (b6) {
            document.getElementById("zone_display").innerHTML += " Ball 6,";
        } else { removeZone(" Ball 6,"); }
    });
    document.getElementById("zone7").addEventListener("click", function () {
        startZone = "Zone7";
        b7 = !b7;
        if (b7) {
            document.getElementById("zone_display").innerHTML += " Ball 7,";
        } else { removeZone(" Ball 7,"); }
    });
    document.getElementById("zone8").addEventListener("click", function () {
        startZone = "Zone8";
        b8 = !b8;
        if (b8) {
            document.getElementById("zone_display").innerHTML += " Ball 8,";
        } else { removeZone(" Ball 8,"); }
    });

    document.getElementById("zone9").addEventListener("click", function () {
        startZone = "Zone9";
        b9 = !b9;
        if (b9) {
            document.getElementById("zone_display").innerHTML += " Ball 9,";
        } else { removeZone(" Ball 9,"); }
    });
    document.getElementById("zone10").addEventListener("click", function () {
        startZone = "Zone10";
        b10 = !b10;
        if (b10) {
            document.getElementById("zone_display").innerHTML += " Ball 10,";
        } else { removeZone(" Ball 10,"); }
    });
    document.getElementById("zone11").addEventListener("click", function () {
        startZone = "Zone11";
        b11 = !b11;
        if (b11) {
            document.getElementById("zone_display").innerHTML += " Ball 11,";
        } else { removeZone(" Ball 11,"); }
    });
    document.getElementById("zone12").addEventListener("click", function () {
        startZone = "Zone12";
        b12 = !b12;
        if (b12) {
            document.getElementById("zone_display").innerHTML += " Ball 12,";
        } else { removeZone(" Ball 12,"); }
    });

    document.getElementById("zone13").addEventListener("click", function () {
        startZone = "Zone13";
        b13 = !b13;
        if (b13) {
            document.getElementById("zone_display").innerHTML += " Ball 13,";
        } else { removeZone(" Ball 13,"); }
    });
    document.getElementById("zone14").addEventListener("click", function () {
        startZone = "Zone14";
        b14 = !b14;
        if (b14) {
            document.getElementById("zone_display").innerHTML += " Ball 14,";
        } else { removeZone(" Ball 14,"); }
    });

    var scoutName = document.getElementById("scout_name");
    var teamNumber = document.getElementById("team_number");
    var matchNumber = document.getElementById("match_number");
    var allianceColor = document.getElementById("alliance_color");
    var robotPresent = document.getElementById("robot_present");
    var exitedTarmac = document.getElementById("exited_tarmac");

    function gather() {
        data += scoutName.value + "."; //string
        data += teamNumber.value + "."; //number
        data += matchNumber.value + "."; //number
        data += allianceColor.value + "."; //string: "red" or "blue"
        data += robotPresent.value + "."; //string: "Yes" or "No"
        data += exitedTarmac.value + "."; //string: "Yes" or "No"
        data += (document.getElementById("zone_display").innerHTML.replace('Balls Selected:', '')).replaceAll(" Ball ", '/').replaceAll(",", "") + ".";//string: "/#"
        data += auton_high_scored + "."; //integer
        data += auton_low_scored + "."; //integer
        data += teleop_high_scored + "."; //integer
        data += teleop_low_scored + "."; //integer
        data += boolToChar(tarmac) + "."; //char: "t" or "f"
        data += boolToChar(launchpad) + "."; //char: "t" or "f"
        data += boolToChar(other) + "."; //char: "t" or "f"
        data += climbLevel() + "."; //string: "none" - did not attempt, "attempted", "low", "middle", "high", "traversal", "" - no input
        data += boolToChar(foul_object) + "."; //char: "t" or "f"
        data += boolToChar(tech_foul_object) + "."; //char: "t" or "f"
        data += boolToChar(yellow_object) + "."; //char: "t" or "f"
        data += boolToChar(red_object) + "."; //char: "t" or "f"
        data += opposing_high_scored + "."; //integer 
        data += opposing_low_scored + "."; //integer 
        data += boolToChar(crashing_object) + "."; //char: "t" or "f"
        data += boolToChar(drivetrain_object) + "."; //char: "t" or "f"
        data += boolToChar(defense_object) + "."; //char: "t" or "f"
        //document.getElementById("display").innerHTML = data; 
        var count = 0;
        for (let i = 0; i < data.length; i++) {
            if (data.charAt(i) == '.') {
                count++;
            }
            if (count == 24) {
                generateQRCode(data.substring(0, i) + ",");
                break;
            }
        }
    }

    function climbLevel() {
        if (none.disabled) {
            return "none";
        } else if (attempted.disabled) {
            return "attempted";
        } else if (low.disabled) {
            return "low";
        } else if (middle.disabled) {
            return "middle";
        } else if (high.disabled) {
            return "high";
        } else if (traversal.disabled) {
            return "traversal";
        } else {
            return "";
        }
    }

    function removeZone(str) {
        document.getElementById("zone_display").innerHTML = document.getElementById("zone_display").innerHTML.replace(str, '');
    }
    function boolToChar(object) {
        if (object.disabled) {
            return 't';
        } else {
            return 'f';
        }
    }
    function clear() {
        scoutName.value = "";
        teamNumber.value = 0;
        matchNumber.value = 0;
        allianceColor.value = "";
        robotPresent.value = "";
        exitedTarmac.value = "";
        document.getElementById("zone_display").innerHTML = "Balls Selected: ";
        autonHigh.innerHTML = "#";
        auton_high_scored = 0;
        autonLow.innerHTML = "0";
        auton_low_scored = 0;
        teleopHigh.innerHTML = "0";
        teleop_high_scored = 0;
        teleopLow.innerHTML = "0";
        teleop_low_scored = 0;
        opposing_high_scored = 0;
        opposingHigh.innerHTML = "0";
        opposing_low_scored = 0;
        opposingLow.innerHTML = "0";
        resetScorePos();
        resetClimb();
        resetFlags();
        document.getElementById("display").innerHTML = "";
        data = "";
    }

    function generateQRCode(str) {
        //print(str);
        //https://github.com/davidshimjs/qrcodejs/blob/master/README.md
        new QRCode(document.getElementById("display"), str);
    }

</script>

</html>